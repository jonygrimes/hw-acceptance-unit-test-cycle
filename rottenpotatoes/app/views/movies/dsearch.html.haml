-# in app/views/movies/dsearch.html.haml

%h1 List of movies directed by: #{@movie.director}

= form_tag movies_path, :method => :get, :id => 'ratings_form' do
  = hidden_field_tag "title_sort", true if @title_header
  = hidden_field_tag ":release_date_sort", true if @date_header
  Include: 
  - @all_ratings.each do |rating|
    = rating
    = check_box_tag "ratings[#{rating}]", 1, @selected_ratings.include?(rating), :id => "ratings_#{rating}"
  = submit_tag 'Refresh', :id => 'ratings_submit'

%table#movies.dsearch
  %thead
    %tr
      %th{:class => @title_header}= link_to 'Movie Title', dsearch_path(:sort => 'title', :ratings => @selected_ratings), :id => 'title_header'
      %th{:class => @rating_header}= link_to 'Rating', dsearch_path(:sort => 'rating', :ratings => @selected_ratings), :id => 'rating_header'
      %th{:class => @date_header}= link_to 'Release Date', dsearch_path(:sort => 'release_date', :ratings => @selected_ratings), :id => 'release_date_header'
      %th{:class => @director_header}= link_to 'Director', dsearch_path(:sort => 'director', :ratings => @selected_ratings), :id => 'director_date_header'
      %th{:class => @description_header}= link_to 'More Info', dsearch_path(:sort => 'description', :ratings => @selected_ratings), :id => 'description_date_header'
  %tbody
    - @movies.each do |movie|
      %tr
        %td= movie.title 
        %td= movie.rating
        %td= movie.release_date
        %td= movie.director
        %td= link_to "More about #{movie.title}", movie_path(movie)

= link_to 'Back to movie list', movies_path